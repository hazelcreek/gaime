<!-- 382f1508-1eb9-4471-aec5-f1a0b3725d88 591bd924-7870-4710-a547-af1e224b43f9 -->
# Add Placement Details for Items and NPCs

## Problem

Currently, locations list items and NPCs by ID only, without specifying WHERE in the room they are positioned (e.g., "on the side table", "standing by the fireplace"). This leads to:

- Generic image generation that can't position elements realistically
- Game master outputs that lack spatial precision

## Solution

Add two optional fields to the location schema:

- `item_placements: dict[str, str]` - Maps item_id to placement description
- `npc_placements: dict[str, str]` - Maps npc_id to placement/position description

Example:

```yaml
entrance_hall:
  items:
    - old_letter
    - candlestick
  item_placements:
    old_letter: "lies crumpled on the dusty side table near the door"
    candlestick: "sits on the fireplace mantel, cold and unlit"
  npcs:
    - butler_jenkins
  npc_placements:
    butler_jenkins: "stands rigidly by the grandfather clock, pale hands clasped"
```

## Files to Modify

### Backend Schema and Logic

1. **[`backend/app/models/world.py`](backend/app/models/world.py)** - Add `item_placements` and `npc_placements` fields to `Location` model
2. **[`backend/app/llm/game_master.py`](backend/app/llm/game_master.py)** - Use placement info when building scene context
3. **[`backend/app/llm/image_generator.py`](backend/app/llm/image_generator.py)** - Pass placement info to image prompts
4. **[`backend/app/llm/world_builder.py`](backend/app/llm/world_builder.py)** - Update prompt to generate placement details

### Existing World Scenarios

5. **[`worlds/cursed-manor/locations.yaml`](worlds/cursed-manor/locations.yaml)** - Add placements for all items/NPCs
6. **[`worlds/detention_survival_high/locations.yaml`](worlds/detention_survival_high/locations.yaml)** - Add placements for all items/NPCs
7. **[`worlds/echoes_of_subjugation/locations.yaml`](worlds/echoes_of_subjugation/locations.yaml)** - Add placements for all items/NPCs

### Documentation

8. **[`docs/WORLD_AUTHORING.md`](docs/WORLD_AUTHORING.md)** - Document new fields with examples
9. **[`docs/ARCHITECTURE.md`](docs/ARCHITECTURE.md)** - Update if state schema section exists
10. **[`docs/API.md`](docs/API.md)** - Update Location model documentation if present

### To-dos

- [ ] Add item_placements and npc_placements fields to Location model
- [ ] Update game master to use placement info in scene descriptions
- [ ] Update image generator to include placement details in prompts
- [ ] Update world builder prompt to generate placement details
- [ ] Add placement details to cursed-manor scenario
- [ ] Add placement details to detention_survival_high scenario
- [ ] Add placement details to echoes_of_subjugation scenario
- [ ] Update WORLD_AUTHORING.md and other relevant docs