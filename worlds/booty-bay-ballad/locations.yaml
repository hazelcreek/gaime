docks_landing:
  name: The Docks
  atmosphere: |
    The smell of salt and questionable fish stew hangs heavy in the air. Seagulls squawk insults from above. To the north, the bustling Town Square awaits. To the east, your own trusty (and rusty) ship, 'The Leaky Tub', is moored.
  visual_description: |
    A sun-bleached wooden pier extending into murky green harbor water, the planks warped and gap-toothed from years of salt exposure. Leaning dock posts wrapped in frayed rope and crusted with barnacles catch the harsh Caribbean sunlight.
    Crates and barrels are stacked haphazardly along the pier edge, some marked with skull-and-crossbones shipping labels. Fishing nets hang drying on racks beside coils of thick hempen rope.
    To the north, a worn cobblestone path climbs uphill toward the bustling Town Square, passing under a weathered wooden archway. To the east, a rickety gangplank with rope railings leads to a battered ship at anchor.
    Seagulls perch on every available surface, eyeing passersby with suspicious, beady eyes. In the background, colorful but crooked buildings climb the hillside, their painted signs swinging in the sea breeze.
  exits:
    north:
      destination: town_square
      scene_description: A cobblestone path leading into the noisy heart of Booty Bay
      destination_known: true
    east:
      destination: ships_deck
      scene_description: The gangplank to your ship, creaking ominously with every wave
      destination_known: true
  item_placements:
    sticky_jail_key:
      placement: Deep inside the Grog Barrel, submerged in spicy liquid.
      hidden: true
      find_condition:
        requires_flag: grog_scooped
  npc_placements: {}
  details:
    grog_barrel:
      name: Grog Barrel
      scene_description: A massive barrel labeled 'XXL SPICY GROG - DO NOT TOUCH'. It rumbles slightly.
  interactions:
    scoop_grog:
      triggers:
      - use ladle_infinite on grog_barrel
      narrative_hint: |-
        You scoop out gallons of fiery liquid with the Ladle of Infinite Scooping. At the bottom, sticky and smelling of nutmeg, lies a key!
      sets_flag: grog_scooped
town_square:
  name: Town Square
  atmosphere: |
    The heart of Booty Bay. Pirates haggle over parrots and peg legs. In the center stands a grand statue of Captain No-Beard McGee, looking heroic and surprisingly clean-shaven.
  visual_description: |
    A bustling cobblestone plaza surrounded by ramshackle two-story buildings with crooked balconies draped in laundry and pirate flags. The warm ochre and faded teal storefronts display hand-painted signs advertising "Peg Legs - Buy 2 Get 1 Free" and "Parrots Taught Bad Words".
    To the west, a lively tavern with weather-beaten green swinging saloon doors beckons, its sign "The Rusty Cutlass" creaking overhead. To the east, a squat stone building with an imposing iron-banded oak door houses the town Brig.
    Market stalls with striped canvas awnings ring the square, selling exotic fruits, rusty weapons, and suspiciously fresh maps. Barrels serve as impromptu tables where pirates play dice and cards.
    Background characters mill about - a one-legged pirate argues with a parrot vendor, a rotund sailor carries an absurdly large fish, and children in tiny tricorn hats chase a three-legged cat. Wanted posters flutter on every available post.
  exits:
    south:
      destination: docks_landing
      scene_description: The path back to the salty docks
      destination_known: true
    west:
      destination: tavern_entrance
      scene_description: Weather-beaten green swinging saloon doors of The Rusty Cutlass Tavern
      destination_known: true
    east:
      destination: brig_entrance
      scene_description: An imposing iron-banded oak door set into a squat stone building - the Brig
      destination_known: true
    down:
      destination: smugglers_cove_entrance
      scene_description: A dark staircase revealed beneath the statue plinth
      destination_known: true
      hidden: true
      find_condition:
        requires_flag: statue_unlocked
  item_placements: {}
  npc_placements: {}
  details:
    statue:
      name: Captain's Statue
      scene_description: |-
        A stone likeness of the Captain. He stands atop a plinth, one arm raised as if holding a bird. The statue looks incomplete without his famous parrot accessory.
    plinth:
      name: Statue Plinth
      scene_description: The base of the statue. It has a parrot-shaped indentation.
  interactions:
    place_parrot:
      triggers:
      - use ceramic_parrot on statue
      narrative_hint: |-
        You fit the Ceramic Parrot onto No-Beard's shoulder. It clicks into place! The plinth rumbles and slides aside, revealing a dark staircase downwards.
      sets_flag: statue_unlocked
tavern_entrance:
  name: The Rusty Cutlass Tavern
  atmosphere: |
    Raucous laughter and terrible music fill the room. The air is thick with smoke and the smell of spilled ale. Pirates arm-wrestle at sticky tables.
  visual_description: |
    A dimly lit tavern interior with low wooden beams draped in tattered flags and fishing nets. Lanterns cast warm pools of amber light across sticky wooden tables scarred with carved initials and knife marks.
    The bar runs along one wall, backed by shelves of mismatched bottles in greens, browns, and ambers. Brass nautical instruments hang as decoration alongside mounted fish of dubious taxidermy quality.
    To the east, weather-beaten green swinging saloon doors let in slashes of bright Caribbean sunlight from the Town Square. To the north, a heavy burgundy velvet curtain with tarnished brass rings conceals the private backroom.
    Roughhewn wooden stools and benches crowd the floor, occupied by silhouetted pirate figures hunched over mugs. Pipe smoke curls toward the ceiling, and playing cards and coins litter every surface.
  exits:
    east:
      destination: town_square
      scene_description: Weather-beaten green swinging saloon doors letting in bright sunlight from the Town Square
      destination_known: true
    north:
      destination: tavern_backroom
      scene_description: A heavy burgundy velvet curtain with tarnished brass rings concealing the private backroom
      destination_known: true
  item_placements:
    ceramic_parrot:
      placement: Clutched in the hand of Bard Barbarossa, who is currently bowing.
    golden_tooth:
      placement: Wedged in the back of the mounted shark head above the bar.
      hidden: true
      find_condition:
        requires_flag: found_golden_tooth
  npc_placements:
    bard_barbarossa:
      placement: Standing on a table, reciting limericks about scurvy.
  details:
    shark_head:
      name: Shark Head
      scene_description: A taxidermied shark with a suspiciously shiny glint in its mouth.
      examine_description: You peer into the shark's maw. Wedged in the back is a solid Golden Tooth!
      on_examine:
        sets_flag: found_golden_tooth
        narrative_hint: You peer into the shark's maw. Wedged in the back is a solid Golden Tooth!
    sign:
      name: Help Wanted Sign
      scene_description: |-
        A 'Help Wanted' sign reads: 'Seeking Cook. Must know difference between sawdust and cumin.'
  interactions:
    slam_poetry:
      triggers:
      - talk bard_barbarossa
      narrative_hint: |-
        You challenge the Bard to an insult slam. You rhyme 'spittoon' with 'baboon'. The crowd goes wild! Barbarossa weeps and hands you his prize trophy.
      sets_flag: won_slam
      gives_item: ceramic_parrot
brig_entrance:
  name: The Brig
  atmosphere: |
    A gloomy stone building. The only sound is the dripping of water and the mournful harmonica playing of a prisoner.
  visual_description: |
    A dim stone anteroom just inside the Brig's iron-banded oak entrance door, which stands open to the west letting in a wedge of bright sunlight from the Town Square beyond.
    The interior walls are thick blocks of moss-covered gray stone, with iron torch sconces holding sputtering candles. Rusty chains and manacles hang from hooks, and old "ESCAPED" wanted posters are nailed everywhere.
    A guard's wooden desk sits against one wall with an abandoned sandwich and playing cards, next to a heavy iron door with a massive rusty padlock leading deeper into the cells.
    Water drips from the low ceiling, collecting in puddles on the uneven stone floor. The air is damp and smells of mildew and regret.
  exits:
    west:
      destination: town_square
      scene_description: Sunlight streaming in from the Town Square
      destination_known: true
    in:
      destination: jail_cell
      scene_description: The heavy iron door leading to the dark cells within
      destination_known: true
  item_placements: {}
  npc_placements: {}
  details:
    door:
      name: Jail Door
      scene_description: A heavy iron door with a massive, rusty padlock.
  requires:
    in:
      item: sticky_jail_key
      fail_msg: The door is locked tight. The padlock is rusted shut and sticky with old grog?
jail_cell:
  name: Jail Cell
  atmosphere: |
    Damp, cold, and smelling of regret. Navigator Ned sits on a wooden bench, looking miserable.
  visual_description: |
    A cramped stone cell viewed through its now-open heavy iron door, which leads back to the Brig's dim anteroom. The door's rusty hinges and massive padlock dangle uselessly.
    Dripping stone walls are covered in scratched tally marks and crude graffiti drawings of ships. A small barred window high on the wall lets in a thin shaft of dusty light.
    A rickety wooden bunk with a moth-eaten straw mattress occupies one corner. A rusty bucket serves as the only amenity, accompanied by a chipped ceramic plate with suspicious crumbs.
    Chains hang from iron rings in the walls, and old bones (possibly chicken, hopefully chicken) are scattered in the corner. A rat peers out from a crack between stones.
  exits:
    out:
      destination: brig_entrance
      scene_description: The iron door leading back to the Brig entrance
      destination_known: true
  item_placements:
    ancient_compass:
      placement: Held tightly by Navigator Ned.
  npc_placements:
    navigator_ned:
      placement: Sitting on the bunk, trying to read a map in the dark.
  details: {}
  interactions:
    free_ned:
      triggers:
      - talk navigator_ned
      narrative_hint: |-
        Ned gasps. 'You opened the door! I'm free! Take this, I won't need it where I'm going (the tavern).' He hands you the Ancient Compass.
      sets_flag: ned_freed
      gives_item: ancient_compass
ships_deck:
  name: Deck of The Leaky Tub
  atmosphere: |
    The deck of your ship. It's seen better days. Ropes coil like snakes and the main mast stretches up into the blue sky.
  visual_description: |
    A weathered ship deck of warped wooden planks, patched in places with mismatched boards. The main mast rises skyward, draped in a tangle of ropes, with patched sails furled and sun-faded to a dingy cream.
    To the west, a rickety gangplank with rope railings connects to the sun-bleached dock. High above, a rope ladder with wooden rungs leads up through the rigging to the distant crow's nest. Near the mast, a narrow wooden hatch with brass handles leads down to the galley below.
    Coiled ropes cover every surface like sleeping snakes, alongside buckets, mops, and a barrel with a suspicious leak leaving a trail of amber liquid. The ship's wheel stands at the stern, missing two spokes.
    The railing is held together with optimism and twine, offering a view of the harbor. A pelican has made a nest in an unused cannon, and a ship's cat lounges in a patch of sunlight.
  exits:
    west:
      destination: docks_landing
      scene_description: The gangplank leading back to the docks
      destination_known: true
    up:
      destination: crows_nest
      scene_description: A rope ladder leading high up to the Crow's Nest
      destination_known: true
    down:
      destination: galley
      scene_description: A narrow hatch leading down to the Galley
      destination_known: true
  item_placements: {}
  npc_placements: {}
  details:
    rope_line:
      name: Rope Line
      scene_description: |-
        A slack line hangs from the mast, looking like it could form a zipline if tightened from above.
galley:
  name: Ship's Galley
  atmosphere: |
    A cramped kitchen. Dirty dishes are piled high. It smells faintly of sawdust and despair.
  visual_description: |
    A cramped below-deck kitchen with low timber ceiling beams blackened by decades of cooking smoke. Above, a narrow wooden hatch with brass handles leads up to the deck, with worn ladder rungs nailed to the wall.
    A cast-iron stove squats in the corner, covered in crusty pots and pans of alarming colors. Open shelves line the walls, stocked with unlabeled jars, hardtack biscuits, and suspiciously bulging sacks.
    Dirty dishes tower in precarious stacks, and a cutting board displays evidence of crimes against vegetables. Dim light filters through a grimy porthole, illuminating dancing dust motes.
    Cockroaches patrol the corners, and a mouse peeks out from behind a flour sack, judging the sanitation.
  exits:
    up:
      destination: ships_deck
      scene_description: The hatch leading back up to the deck
      destination_known: true
  item_placements:
    ladle_infinite:
      placement: Stuck into a pot of solidified oatmeal.
  npc_placements: {}
  details:
    sack:
      name: Flour Sack
      scene_description: |-
        A sack in the corner labeled 'Premium Flour'. It is ripped open, revealing pure sawdust inside.
crows_nest:
  name: Crow's Nest
  atmosphere: |
    High above the bay. The wind whips your hair. You can see the whole island from here.
  visual_description: |
    A small wooden platform at the top of the mast, enclosed by a waist-high railing of weathered timber. The platform is barely big enough for two people, cluttered with a battered spyglass and wind-torn signal flags.
    A rope ladder with worn wooden rungs descends through the tangle of rigging toward the distant deck far below. The ropes and rigging converge at this point like a spider's web.
    From this vantage point, the entire harbor spreads out below - colorful rooftops, the glittering bay, distant islands on the horizon. The sky is a brilliant blue dome stretching in every direction, with fluffy clouds drifting lazily past.
    A territorial seagull has claimed one corner, surrounded by the remains of unfortunate fish.
  exits:
    down:
      destination: ships_deck
      scene_description: The rope ladder descending to the deck below
      destination_known: true
    zipline:
      destination: ships_deck
      scene_description: A taut zipline ready for a thrilling descent
      destination_known: true
      hidden: true
      find_condition:
        requires_flag: zipline_active
  item_placements:
    rusty_cutlass:
      placement: Embedded in the wooden railing.
  npc_placements:
    weeping_lookout:
      placement: Curled up in a ball, sobbing into his spyglass.
  details:
    counterweight_rope:
      name: Counterweight Rope
      scene_description: |-
        A thick rope holding a heavy counterweight. If cut, it might snap the zipline tight.
  interactions:
    cut_rope:
      triggers:
      - use rusty_cutlass on counterweight_rope
      narrative_hint: |-
        You saw through the rope. SNAP! The counterweight drops, pulling the zipline taut. You can now zip down to the deck instantly!
      sets_flag: zipline_active
    talk_lookout:
      triggers:
      - talk weeping_lookout
      narrative_hint: |-
        The lookout wails, 'I dropped the Jail Key! It fell right into a barrel of Spicy Grog on the docks! I'm doomed!'
smugglers_cove_entrance:
  name: Smuggler's Cove Entrance
  atmosphere: |
    A dark, rocky tunnel revealed beneath the statue. The air is cool and smells of gold and mildew.
  visual_description: |
    A rough-hewn stone staircase carved beneath the Town Square, with the rectangular opening above framed by the shifted statue plinth letting in bright Caribbean sunlight. The stone steps descend into cool darkness.
    The walls glisten with moisture and are veined with mineral deposits that catch the faint light from above. Cobwebs drape the corners like tattered curtains, and puddles of dark water collect in the uneven steps.
    Carved into the walls are old pirate symbols and crude arrows pointing deeper - generations of smugglers left their marks here. The last rays of daylight barely reach the first landing where old wooden crates and rusted anchor chains lie abandoned.
    Below, a winding tunnel mouth yawns into pitch blackness, the passage twisting out of sight.
  exits:
    up:
      destination: town_square
      scene_description: The stone staircase leading back up to the Town Square
      destination_known: true
    down:
      destination: treasure_cave
      scene_description: A winding, pitch-black tunnel descending into the depths
      destination_known: false
  item_placements: {}
  npc_placements: {}
  details:
    darkness:
      name: Dark Tunnel
      scene_description: The tunnel ahead is pitch black and winding.
  requires:
    down:
      item: ancient_compass
      fail_msg: |-
        You can't navigate the twisting, pitch-black tunnels without an Ancient Compass. You'd get lost instantly.
treasure_cave:
  name: The Treasure Cave
  atmosphere: |
    A massive cavern illuminated by glowing moss. In the center, a pile of gold glitters.
  visual_description: |
    A vast underground cavern with a domed ceiling covered in bioluminescent moss casting an ethereal blue-green glow. Stalactites hang like stone chandeliers, some dripping into crystal-clear pools.
    At one end, a winding tunnel mouth emerges from the darkness - the passage back up to the smuggler's entrance and the surface world above.
    Mountains of gold coins, jeweled goblets, and glittering treasures are piled throughout the cave, spilling from rotted wooden chests. Precious gems catch the moss-light and scatter rainbow reflections across the walls.
    Ancient pirate skeletons in tattered finery are scattered among the treasure, eternal guardians who never spent their ill-gotten gains. A crown sits crookedly on one skull.
  exits:
    up:
      destination: smugglers_cove_entrance
      scene_description: The winding tunnel leading back up toward the surface
      destination_known: true
  item_placements: {}
  npc_placements: {}
  details:
    chest:
      name: Treasure Chest
      scene_description: The legendary chest of Captain No-Beard.
tavern_backroom:
  name: Tavern Backroom
  atmosphere: |
    A private room for high-stakes card games. It's surprisingly quiet.
  visual_description: |
    An intimate private room accessed through a heavy burgundy velvet curtain with tarnished brass rings, which hangs in the doorway to the south leading back to the main tavern's noise and smoke.
    The walls are paneled in dark wood, adorned with faded paintings of naval battles. A single brass chandelier with half its candles burnt out casts dim, uneven light across the space.
    A large round table covered in green felt dominates the center, surrounded by high-backed chairs in cracked leather. Playing cards, coins, and a crystal decanter with amber liquid sit ready for use.
    Heavy drapes cover a single window, and the room has no other exits. A stuffed parrot in a glass case watches with glass eyes, and cigar smoke has permanently stained the ceiling.
  exits:
    south:
      destination: tavern_entrance
      scene_description: The heavy burgundy velvet curtain leading back to the main tavern
      destination_known: true
  item_placements: {}
  npc_placements: {}
  details:
    table:
      name: Card Table
      scene_description: A card table covered in green felt.
captains_cabin:
  name: Captain's Cabin
  atmosphere: |
    Located at the stern of the ship (accessed from deck, though door was stuck before). Wait, this is just a narrative flavor room attached to the deck logic.
  visual_description: |
    A cramped but cozy cabin at the ship's stern, with the cabin door to the main deck standing ajar, letting in the sounds of creaking rigging and distant seagulls.
    Large stern windows offer a view of the ship's wake and the open sea. Sun streams through the salt-encrusted glass, illuminating dancing dust motes.
    A bunk with threadbare blankets is built into one wall, while a writing desk cluttered with maps, quills, and empty rum bottles occupies another. A hammock hangs ready as backup bedding.
    Maritime decorations cover every surface - a sextant, a ship in a bottle, framed charts, and a portrait of someone's mother glaring disapprovingly. The floorboards creak with every wave.
  exits:
    out:
      destination: ships_deck
      scene_description: The cabin door leading back to the main deck
      destination_known: true
  item_placements:
    ghost_diary:
      placement: Tucked under a loose floorboard.
      hidden: true
      find_condition:
        requires_flag: examined_floorboard
  npc_placements: {}
  details:
    floorboard:
      name: Loose Floorboard
      scene_description: A loose floorboard squeaks under your foot.
      examine_description: You pry up the board. Underneath is a dusty diary belonging to a Ghost Pirate.
      on_examine:
        sets_flag: examined_floorboard
        narrative_hint: You pry up the board. Underneath is a dusty diary belonging to a Ghost Pirate.
zipline_descent:
  name: Mid-Air Zipline
  atmosphere: WHEEEEEEEEEE!
  visual_description: |
    A dizzying view of the ship's deck rushing up from below, seen from a taut rope stretched between the crow's nest and a lower point. The harbor spreads out in miniature, with the town a colorful jumble in the distance.
    Wind-blurred motion lines suggest the speed of descent. The rope vibrates with tension, and a seagull flaps out of the way with an indignant squawk.
    The deck below grows rapidly larger, with coiled ropes and barrels becoming more distinct by the second. A concerned ship's cat looks up with wide eyes.
  exits:
    land:
      destination: ships_deck
      scene_description: The deck of your ship rushing up to meet you
      destination_known: true
  item_placements: {}
  npc_placements: {}
  details: {}
