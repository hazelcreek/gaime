# Test World Locations (V3 Schema)
#
# Layout:
#   [locked_room] (north, requires door_unlocked)
#         |
#   [start_room] --- [secret_room] (east, requires knows_secret)
#
# This provides test coverage for:
# - Basic navigation
# - Flag-based access control
# - Container interactions
# - NPC presence
# - Hidden items with visibility conditions (V3)
# - Exit examination with destination reveal (Phase 4)
# - on_examine effects (Phase 4)

start_room:
  name: "Starting Room"
  atmosphere: |
    A simple room with plain walls and wooden floors.
    Exits lead north and east. A wooden box sits in the corner.
  exits:
    north:
      destination: locked_room
      scene_description: "A sturdy wooden door with an iron lock mechanism"
      examine_description: "The iron lock mechanism is old but functional. This seems to lead to a secure room."
      destination_known: false
      reveal_destination_on_examine: true  # Phase 4: examining reveals destination
    east:
      destination: secret_room
      scene_description: "A section of wall that looks slightly different from the rest"
      destination_known: false
      reveal_destination_on_flag: found_secret_door  # Phase 4: flag reveals destination
  details:
    floor:
      name: "Wooden Floor"
      scene_description: "Plain wooden floorboards, slightly dusty."
    walls:
      name: "Stone Walls"
      scene_description: "Bare stone walls with no decoration."
    box:
      name: "Wooden Box"
      scene_description: "A small wooden box with a brass clasp."
      examine_description: "You open the brass clasp and peer inside the box."
      on_examine:
        sets_flag: box_opened
        narrative_hint: "The box opens to reveal its contents"
  # V3: item_placements defines WHICH items are here AND their visibility
  item_placements:
    test_key:
      placement: "catches the light on the floor"
    container_box:
      placement: "sits in the corner"
    hidden_gem:
      placement: "glints from inside the box"
      hidden: true
      find_condition:
        requires_flag: box_opened
  # V3: npc_placements defines WHICH npcs are here
  npc_placements:
    test_npc:
      placement: "stands near the east wall"

locked_room:
  name: "Locked Room"
  atmosphere: |
    A previously locked room, now accessible.
    The door to the south leads back to the starting room.
  exits:
    south:
      destination: start_room
      scene_description: "The doorway back to the starting room"
      destination_known: true
  requires:
    flag: door_unlocked
  details:
    door:
      name: "Wooden Door"
      scene_description: "A heavy wooden door with an iron lock."
  interactions:
    examine_lock:
      triggers:
        - "examine lock"
        - "look at door"
      narrative_hint: "The lock is now open"

secret_room:
  name: "Secret Room"
  atmosphere: |
    A hidden chamber that glows with an inner light.
    Ancient symbols are carved into the walls.
  exits:
    west:
      destination: start_room
      scene_description: "The passage back to the starting room"
      destination_known: true
  requires:
    flag: knows_secret
  details:
    symbols:
      name: "Glowing Symbols"
      scene_description: "Strange glowing symbols pulse with energy."
    altar:
      name: "Stone Altar"
      scene_description: "A stone altar in the center of the room."
  interactions:
    solve_puzzle:
      triggers:
        - "use gem on altar"
        - "place gem"
        - "solve puzzle"
      narrative_hint: "The gem glows and the puzzle is complete"
      sets_flag: puzzle_solved
